# Health-InfraOps Custom Application Log Rotation
# Specific rotation rules for Health InfraOps applications

# Main application logs
/opt/health-infraops/logs/deployments/*.log
/opt/health-infraops/logs/health-checks/*.log
/opt/health-infraops/logs/backups/*.log
/opt/health-infraops/logs/recovery/*.log
{
    daily
    rotate 30
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 infraops infraops
    postrotate
        # Notify log management system about rotation
        curl -X POST -H "Content-Type: application/json" \
        -d '{"event":"log_rotation","application":"health-infraops","timestamp":"'"$(date -Iseconds)"'"}' \
        http://monitoring:9090/api/events > /dev/null 2>&1 || true
    endscript
}

# High-frequency operation logs
/opt/health-infraops/logs/operations/*.log
{
    hourly
    rotate 24
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 infraops infraops
}

# Large backup operation logs
/opt/health-infraops/backups/logs/*.log
{
    daily
    rotate 14
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 backup backup
    size 100M
}

# Security audit logs
/opt/health-infraops/logs/security/*.log
/opt/health-infraops/security/audit/*.log
{
    weekly
    rotate 52
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 600 security security
}

# Database operation logs
/opt/health-infraops/logs/database/*.log
{
    daily
    rotate 7
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 dba dba
}

# Infrastructure provisioning logs
/opt/health-infraops/logs/infrastructure/*.log
/opt/health-infraops/automation/terraform/logs/*.log
{
    daily
    rotate 30
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 terraform terraform
}

# Monitoring and alerting logs
/opt/health-infraops/logs/monitoring/*.log
/opt/health-infraops/monitoring-dashboards/logs/*.log
{
    daily
    rotate 14
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 monitoring monitoring
}

# API and microservice logs
/opt/health-infraops/logs/api/*.log
/opt/health-infraops/logs/microservices/*.log
{
    daily
    rotate 21
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 api api
}

# Disaster recovery logs
/opt/health-infraops/logs/disaster-recovery/*.log
/opt/health-infraops/backups/recovery/logs/*.log
{
    weekly
    rotate 26
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 recovery recovery
}

# Performance testing logs
/opt/health-infraops/logs/performance/*.log
/opt/health-infraops/logs/load-testing/*.log
{
    daily
    rotate 7
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 performance performance
}

# Compliance and audit logs (long-term retention)
/opt/health-infraops/logs/compliance/*.log
/opt/health-infraops/logs/hipaa/*.log
{
    monthly
    rotate 84
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 600 compliance compliance
}

# Real-time processing logs
/opt/health-infraops/logs/streaming/*.log
{
    hourly
    rotate 48
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 streaming streaming
    size 50M
}

# Batch processing logs
/opt/health-infraops/logs/batch/*.log
{
    daily
    rotate 14
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 batch batch
}

# Health check and monitoring logs
/opt/health-infraops/logs/healthcheck/*.log
{
    daily
    rotate 7
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 healthcheck healthcheck
}

# Custom metrics and analytics logs
/opt/health-infraops/logs/analytics/*.log
/opt/health-infraops/logs/metrics/*.log
{
    daily
    rotate 30
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 analytics analytics
}

# Notification and alert logs
/opt/health-infraops/logs/notifications/*.log
/opt/health-infraops/logs/alerts/*.log
{
    daily
    rotate 14
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 alerts alerts
}

# Size-based rotation for large diagnostic logs
/opt/health-infraops/logs/diagnostics/*.log
{
    size 500M
    rotate 5
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 diagnostics diagnostics
}

# High-availability cluster logs
/opt/health-infraops/logs/cluster/*.log
/opt/health-infraops/logs/ha/*.log
{
    daily
    rotate 14
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 cluster cluster
}

# Cache and performance logs
/opt/health-infraops/logs/cache/*.log
/opt/health-infraops/logs/performance/*.log
{
    daily
    rotate 7
    missingok
    compress
    delaycompress
    notifempty
    copytruncate
    create 644 cache cache
}