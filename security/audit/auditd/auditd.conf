# Health-InfraOps Audit Daemon Configuration
# Infokes Healthcare System - Comprehensive Auditing

# Basic configuration
log_file = /var/log/audit/audit.log
log_format = RAW
log_group = root
priority_boost = 4
flush = INCREMENTAL_ASYNC
freq = 50
max_log_file = 100
num_logs = 5
disp_qos = lossy
dispatcher = /sbin/audispd
name_format = NONE
##name = mydomain
max_log_file_action = ROTATE
space_left = 75
space_left_action = SYSLOG
verify_email = yes
action_mail_acct = security@infokes.co.id
admin_space_left = 50
admin_space_left_action = SUSPEND
disk_full_action = SUSPEND
disk_error_action = SUSPEND
##tcp_listen_port = 
tcp_listen_queue = 5
tcp_max_per_addr = 1
##tcp_client_ports = 1024-65535
tcp_client_max_idle = 0
enable_krb5 = no
krb5_principal = auditd
##krb5_key_file = /etc/audit/audit.key

# Health-InfraOps specific settings
# Increase buffer size for high-traffic systems
num_logs = 10
max_log_file = 50
max_log_file_action = ROTATE

# Email alerts for critical events
action_mail_acct = security@infokes.co.id
space_left_action = email
admin_space_left_action = halt

# Real-time monitoring
disp_qos = lossless

# Performance tuning for busy systems
flush = INCREMENTAL
freq = 20

# Network logging (optional)
# tcp_listen_port = 60
# tcp_client_max_idle = 300

# Plugin configuration
active = yes
direction = out
path = builtin_af_unix
type = builtin 
args = 0640 /var/run/audispd_events
format = string

# Health-InfraOps custom plugins
active = yes
direction = out
path = /usr/share/audit/health-infraops-plugin
type = always 
args = /var/log/health-infraops-audit/security-events.log
format = string

# Enhanced logging for compliance
log_format = ENHANCED
log_group = adm
priority_boost = 4

# Disk space management
space_left = 100
space_left_action = email
admin_space_left = 75
admin_space_left_action = SINGLE
disk_full_action = SINGLE
disk_error_action = SUSPEND

# Network configuration for remote logging
# tcp_listen_port = 60
# tcp_max_per_addr = 5
# tcp_client_ports = 1024-65535
# tcp_client_max_idle = 300

# Rate limiting
rate_limit = 200
burst_limit = 400

# Health-InfraOps compliance settings
# HIPAA - 6 years retention
num_logs = 24
max_log_file = 100

# PCI DSS - 1 year retention with immediate alerting
flush = SYNC
freq = 1

# GDPR - Immediate breach notification
space_left_action = email
admin_space_left_action = SINGLE

# Fail-safe configuration
disk_full_action = SINGLE
disk_error_action = SUSPEND

# Security-enhanced configuration
log_group = adm
write_logs = yes
log_file = /var/log/audit/audit.log
format = RAW
log_format = ENRICHED

# Performance optimization for high-load systems
buffer_size = 16384
overflow_action = SYSLOG
max_restarts = 10
plugin_dir = /etc/audit/plugins.d

# Health-InfraOps specific plugin configuration
active = yes
path = /usr/sbin/audispd
type = always
args = /var/log/health-infraops-audit/processed.log
format = string